<!--#set var="TITLE" value="TopoTools Plugin, Version 1.7"-->
<!--#include virtual="/include/header-over.shtml"-->

<!-- CONTENT STARTS HERE -->

<div style="float:right; boder:2px;">
  <p>&nbsp;&nbsp;&nbsp;<underline><strong>Contents</strong></underline></p>
  <ul class="goog-toc" style="list-style: none;">
    <li class="goog-toc"><a href="#TOC-Scope-and-usage"><strong>1 </strong>Scope and usage</a></li>
    <li class="goog-toc"><a href="#TOC-Version"><strong>2 </strong>Version</a></li>
    <li class="goog-toc"><a href="#TOC-Main-command-interface"><strong>3 </strong>Main command interface</a>
      <ul class="goog-toc" style="list-style: none;">
        <li class="goog-toc"><a href="#TOC-Common-flags"><strong>3.1 </strong>Common flags</a></li>
        <li class="goog-toc"><a href="#TOC-numatoms"><strong>3.2 </strong>numatoms</a></li>
        <li class="goog-toc"><a href="#TOC-numatomtypes"><strong>3.3 </strong>numatomtypes</a></li>
        <li class="goog-toc"><a href="#TOC-atomtypenames"><strong>3.4 </strong>atomtypenames</a></li>
        <li class="goog-toc"><a href="#TOC-guessatom-property-from-"><strong>3.5 </strong>guessatom &lt;property&gt; &lt;from&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-numbonds"><strong>3.6 </strong>numbonds</a></li>
        <li class="goog-toc"><a href="#TOC-numbondtypes"><strong>3.7 </strong>numbondtypes</a></li>
        <li class="goog-toc"><a href="#TOC-bondtypenames"><strong>3.8 </strong>bondtypenames</a></li>
        <li class="goog-toc"><a href="#TOC-clearbonds"><strong>3.9 </strong>clearbonds</a></li>
        <li class="goog-toc"><a href="#TOC-retypebonds"><strong>3.10 </strong>retypebonds</a></li>
        <li class="goog-toc"><a href="#TOC-addbond-id1-id2-"><strong>3.11 </strong>addbond &lt;id1&gt; &lt;id2&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-delbond-id1-id2-"><strong>3.12 </strong>delbond &lt;id1&gt; &lt;id2&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-getbondlist-type-order-both-none-"><strong>3.13 </strong>getbondlist [type|order|both|none]</a></li>
        <li class="goog-toc"><a href="#TOC-setbondlist-type-order-both-none-li"><strong>3.14 </strong>setbondlist [type|order|both|none] &lt;list&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-num-angle-dihedral-improper-s"><strong>3.15 </strong>num(angle|dihedral|improper|crossterm)s</a></li>
        <li class="goog-toc"><a href="#TOC-num-angle-dihedral-improper-types"><strong>3.16 </strong>num(angle|dihedral|improper)types</a></li>
        <li class="goog-toc"><a href="#TOC-angle-dihedral-improper-typenames"><strong>3.17 </strong>(angle|dihedral|improper)typenames</a></li>
        <li class="goog-toc"><a href="#TOC-clear-angle-dihedral-improper-s"><strong>3.18 </strong>clear(angle|dihedral|improper|crossterm)s</a></li>
        <li class="goog-toc"><a href="#TOC-sort-angle-dihedral-improper-s"><strong>3.19 </strong>sort(angle|dihedral|improper)s</a></li>
        <li class="goog-toc"><a href="#TOC-retype-angle-dihedral-improper-s"><strong>3.20 </strong>retype(angle|dihedral|improper)s</a></li>
        <li class="goog-toc"><a href="#TOC-guess-angle-dihedral-s"><strong>3.21 </strong>guess(angle|dihedral)s</a></li>
        <li class="goog-toc"><a href="#TOC-guessimproper-tolerance-degrees-"><strong>3.22 </strong>guessimpropers [tolerance &lt;degrees&gt;]</a></li>
        <li class="goog-toc"><a href="#TOC-addangle-type-id1-id2-id3-"><strong>3.23 </strong>addangle &lt;type&gt; &lt;id1&gt; &lt;id2&gt; &lt;id3&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-delangle-id1-id2-id3-"><strong>3.24 </strong>delangle &lt;id1&gt; &lt;id2&gt; &lt;id3&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-getanglelist"><strong>3.25 </strong>getanglelist</a></li>
        <li class="goog-toc"><a href="#TOC-setanglelist-list-"><strong>3.26 </strong>setanglelist &lt;list&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-adddihedral-type-id1-id2-id3-id4-"><strong>3.27 </strong>adddihedral &lt;type&gt; &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-deldihedral-idx1-id2-id3-id4-"><strong>3.28 </strong>deldihedral &lt;idx1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-addimproper-type-id1-id2-id3-id4-"><strong>3.29 </strong>addimproper &lt;type&gt; &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-delimproper-id1-id2-id3-id4-"><strong>3.30 </strong>delimproper &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-get-dihedral-improper-list"><strong>3.31 </strong>get(dihedral|improper)list</a></li>
        <li class="goog-toc"><a href="#TOC-set-dihedral-improper-list-list-"><strong>3.32 </strong>set(dihedral|improper)list &lt;list&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-addcrossterm"><strong>3.33 </strong>addcrossterm &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;id5&gt; &lt;id6&gt; &lt;id7&gt; &lt;id8&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-delcrossterm"><strong>3.34 </strong>delcrossterm &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;id5&gt; &lt;id6&gt; &lt;id7&gt; &lt;id8&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-getcrosstermlist"><strong>3.35 </strong>getcrosstermlist</a></li>
        <li class="goog-toc"><a href="#TOC-setcrosstermlist"><strong>3.36 </strong>setcrosstemlist &lt;list&gt;</a></li>

      </ul>
    </li>
    <li class="goog-toc"><a href="#TOC-File-I-O-Commands"><strong>4 </strong>File I/O Commands</a>
      <ul class="goog-toc" style="list-style: none;">
        <li class="goog-toc"><a href="#TOC-readlammpsdata-file-name-atom-style"><strong>4.1 </strong>readlammpsdata &lt;file name&gt; [&lt;atom style&gt;]</a></li>
        <li class="goog-toc"><a href="#TOC-writelammpsdata-file-name-atom-styl"><strong>4.2 </strong>writelammpsdata &lt;file name&gt; [&lt;atom style&gt;]</a></li>
        <li class="goog-toc"><a href="#TOC-readvarxyz-file-name-"><strong>4.3 </strong>readvarxyz &lt;file name&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-writevarxyz-file-name-selmod-sel-fi"><strong>4.4 </strong>writevarxyz &lt;file name&gt; [selmod &lt;sel&gt;] [first|last|step &lt;frame]</a></li>
        <li class="goog-toc"><a href="#TOC-writegmxtop-file-name-"><strong>4.5 </strong>writegmxtop &lt;file name&gt;</a></li>
      </ul>
    </li>
    <li class="goog-toc"><a href="#TOC-Utility-Functions"><strong>5 </strong>Utility Functions</a>
      <ul class="goog-toc" style="list-style: none;">
        <li class="goog-toc"><a href="#TOC-selections2mol-list-of-atom-selecti"><strong>5.2 </strong>selections2mol &lt;list of atom selections&gt;</a></li>
        <li class="goog-toc"><a href="#TOC-replicatemol-mol-nx-ny-nz-"><strong>5.3 </strong>replicatemol &lt;mol&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt;</a></li>
      </ul>
    </li>
    <li class="goog-toc"><a href="#TOC-Author"><strong>5 </strong>Author</a></li>
  </ul>
</div>

    <h3><a name="TOC-Scope-and-usage"></a>Scope and usage</h3>
    <p align="justify">
      Starting with VMD version 1.8.7 it is now possible to store the complete
      topology information, i.e. not only bonds, but also angle, dihedral, and
      improper definitions as well as their force field type labels (if
      available). This now allows to do a large variety of modifications to
      topology data or even building topologies from scratch. The focus lies
      hereby on being able to perform many operations manually or scripted and
      thus being less focused on and optimized for biomolecules like
      psfgen.</p> 
    <p align="justify">In combination with the new command
      <tt><code>mol new atoms &lt;number&gt;</code></tt> it is now also
      possible to do many operations directly that previously required writing
      and manipulating temporary files and reading them back into VMD, or even
      write complete molecule or simulation data readers in Tcl script. This
      is especially useful for file formats, where additional input from the
      user is required, for example reading LAMMPS format "data" (=topology)
      files, where the "style" of the<i>Atoms</i> section cannot be deduced
      from the data. Of course write support is also possible.</p> 
    <p align="justify">The underlying Tcl script API in VMD itself had been
      designed to be minimalistic, since most operations are not
      computationally demanding and could be programmed with scripting. The
      <b>topotools</b> packages is supposed to provide a <i>middleware</i>,
      i.e. more powerful and easy to use script commands that make combine
      multiple low lever commands in a way to solve common tasks conveniently
      and efficiently.</p>
    <p align="justify">Finally <b>topotools</b> also contains some utilities and
      applications for more complex operations like combining multiple molecules 
      (=different files) or multiple  selections into one new molecule, or building
      larger systems by replicating a given unitcell.</p>
    <p align="justify">Updates and bug fixes for topotools between VMD releases
      are available from <a href="http://sites.google.com/site/akohlmey/software/topotools">http://sites.google.com/site/akohlmey/software/topotools</a>. 
      This page also links to a set of tutorial examples that demonstrate in more
      detail, how the commands in the plugin can be used to build topology
      data files for different kinds of MD simulation packages.</p>


<h3><a name="TOC-Version"></a>Version</h3>
<p align="justify">This documentation describes the version of the topotools plugin that is displayed in the title.</p>
<h3><a name="TOC-Main-command-interface"></a>Main command interface</h3>
<p align="justify">This is the <i>middleware</i> part of the package that provides abstract operations on top of the low-level API. This is modeled after the example of the internal <code>mol</code> or <code>molinfo</code> commands, or the <code>pbc</code> command from the PBCTools package to provide a somewhat consistent interface to the functionality. All command lines start with the <tt>topo</tt> keyword and then take a subcommand name to determine the actual functionality that is requested.</p>
<div class="sites-codeblock sites-codesnippet-block"><code>topo &lt;command&gt; [args...] &lt;flags&gt;</code></div>
<h4><a name="TOC-Common-flags"></a>Common flags</h4>
<p align="justify">The following flags can be passed on to all subsequent <code>topo</code> commands. They will select the molecule to which the operation should be applied to and also the set of atoms. The <code>-sel</code> transparently handles both, previously defined selection functions or selection texts, as arguments. For operations on bonds, angles, dihedrals, and impropers selections will be applied in such a way that only topological data where <b>all</b> atoms are contained in the selection.</p>
<div class="sites-codeblock sites-codesnippet-block"><code>
<div>-molid &lt;num&gt;|top &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;molecule id (default: 'top')</div>
<div>-sel &lt;selection&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;atom selection function or text (default: 'all')</div>
</code></div>
<p align="justify">The following flags can be added to subsequently documented operations on bonds. Bond information is treated and stored differently from angles, dihedrals, and impropers in VMD, since bond information is used for visualization and the others not. This also results in performance differences in commands operating on the two groups.</p>
<div class="sites-codeblock sites-codesnippet-block"><code>
<div>-bondtype &nbsp;&lt;typename&gt; &nbsp; bond type name (default: unknown)</div>
<div>-bondorder &lt;bondorder&gt; &nbsp;bond order parameter (default: 1)</div>
</code></div>
<h4><a name="TOC-numatoms"></a>numatoms</h4>
<p>Returns the number of atoms.</p>
<h4><a name="TOC-numatomtypes"></a>numatomtypes</h4>
<p>Returns the number of atom types as determined from the <code>type</code> property.</p>
<h4><a name="TOC-atomtypenames"></a>atomtypenames</h4>
<p>Returns the list of unique atom types names. The list has <code>topo numatomtypes</code> entries.</p>
<h4><a name="TOC-guessatom-property-from-"></a>guessatom &lt;property&gt; &lt;from&gt;</h4>
<p align="justify">Resets per atom data through selected heuristics. This is most useful to recover some data when using a file format that doesn't set contain these properties, or when they cannot be reliably determined, so the user should choose which ones work. The following combinations are supported:</p>
<ul>
<li><code>element</code> from <code>mass</code>: this assigns the closest match in the periodic table of elements.</li>
<li><code>element</code> from <code>name</code>: the atom name is looked up in the periodic table of elements, if no match is found the first two characters of the name are used and if there is still no match, then only the first character of the name is taken. The lookup is case insensitive since version 1.2 of the plugin.</li>
<li><code style="color:rgb(0, 96, 0)">element</code> from <code style="color:rgb(0, 96, 0)">type</code>: the atom type is looked up in the periodic system of elements in the same way as described for name (added in version 1.2).</li>
<li><code>mass</code> from <code>element</code>: the element name is compared against the periodic table of elements (case insensitively) and the mass looked up.</li>
<li><code>name</code> from <code>element</code>: the name is set to the element name with all uppercase characters.</li>
<li><code style="color:rgb(0, 96, 0)">name</code> from <code style="color:rgb(0, 96, 0)">type</code>: the atom type is copied to atom name.</li>
<li><code>radius</code> from <code>element</code>: the radius is looked up by element name. van-der-Walls radii are used for most elements, ionic radii for elements that are commonly ionic and 2.0 is used for all other elements.</li>
<li><code>type</code> from <code>element</code>: the type is set to the element name with all uppercase characters.</li>
<li><code>type</code> from <code>name</code>: the atom name is copied to atom type.</li>
<li><code>lammps</code> from <code>data</code>: this is a shortcut notation for guessing <code>element</code> from <code>mass</code> and then <code>name</code> and <code>radius</code> from the <code>element</code>. This is a combination that can be applied to many LAMMPS data files.</li>
</ul>
<h4><a name="TOC-numbonds"></a>numbonds</h4>
<p align="justify">Returns the number of bonds.</p>
<h4><a name="TOC-numbondtypes"></a>numbondtypes</h4>
<p align="justify">Returns the number of unique bond types.</p>
<h4><a name="TOC-bondtypenames"></a>bondtypenames</h4>
<p align="justify">Returns a list of all unique bond types. The list has <code style="color:rgb(0, 96, 0)">topo numbondtypes</code> entries.</p>
<h4><a name="TOC-clearbonds"></a>clearbonds</h4>
<p align="justify">Delete all bonds.
</p>
<h4><a name="TOC-retypebonds"></a>retypebonds</h4>
<p align="justify">Assign new bond types composed of the atom type strings connected with a '-' character. Bond types are canonicalized so that the atom type with the lower dictionary sort value will be placed on the left and the other on the right.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-addbond-id1-id2-"></a>addbond &lt;id1&gt; &lt;id2&gt; [-bondtype &lt;type&gt;] [-bondorder &lt;order&gt;]</h4>
<p align="justify">Defines a bond bone between the two specified atoms. This does nothing if one of the two atom indices is outside the selection. You can specify the bond type and order via the optional flags <code>-bondtype</code> or <code>-bondorder</code>.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-delbond-id1-id2-"></a>delbond &lt;id1&gt; &lt;id2&gt;</h4>
<p align="justify">Deletes a bond between the two specified atoms. This does nothing if the bond does not exist or one of the two atom indices is outside the selection.</p>
<h4><a name="TOC-getbondlist-type-order-both-none-"></a>getbondlist [type|order|both|none]</h4>
<p align="justify">Returns a list of unique bonds, the individual bond is a list of the atom indices forming the bond and optionally added the bond type name and/or the bond order value.</p>
<h4><a name="TOC-setbondlist-type-order-both-none-li"></a>setbondlist [type|order|both|none] &lt;list&gt;</h4>
<p align="justify">Defines bonds from a list in a format as returned by <code>topo getbondlist</code>. This is essentially a shortcut for calling <code>topo clearbonds</code> and a sequence of <code>topo addbond</code> commands with some optimization for the case of a selection encompassing all atoms.</p>
<h4><a name="TOC-num-angle-dihedral-improper-s"></a>num(angle|dihedral|improper|crossterm)s</h4>
<p align="justify">Returns the number of angles, dihedrals, impropers or crossterms.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-num-angle-dihedral-improper-types"></a>num(angle|dihedral|improper)types</h4>
<p align="justify">Returns the number of unique angle-, dihedral-, or improper-types.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-angle-dihedral-improper-typenames"></a>(angle|dihedral|improper)typenames</h4>
<p align="justify">Returns a list of all unique angles, dihedrals, or impropers. The list has <code style="color:rgb(0, 96, 0)">topo num(angle|dihedral|improper)types</code> entries.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-clear-angle-dihedral-improper-s"></a>clear(angle|dihedral|improper|crossterm)s</h4>
<p align="justify">Deletes the currently defined angles, dihedrals, impropers, or crossterms.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-sort-angle-dihedral-improper-s"></a>sort(angle|dihedral|improper)s</h4>
<p align="justify">Sorts and canonicalizes the list of angles, dihedrals, or impropers. Duplicates are removed and the list is sorted by atom types.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-retype-angle-dihedral-improper-s"></a>retype(angle|dihedral|improper)s</h4>
<p align="justify">Assign new angle, dihedral, or improper types composed of the atom type strings connected with a '-' character. The resulting types are canonicalized and sorted.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-guess-angle-dihedral-s"></a>guess(angle|dihedral)s</h4>
<p align="justify">Guess angle or dihedral definitions from the bond topology. An angle is defined by two bonds sharing an atom and a dihedral by two bonds sharing a bond. Types are assigned in the same way as in the corresponging retype command.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-guessimproper-tolerance-degrees-"></a>guessimpropers [tolerance &lt;degrees&gt;]</h4>
<p align="justify">Guess improper angles. Are defined for atoms that are bonded to <b>exactly</b> 3 atoms when they form a near flat structure. The <code>tolerance</code> flag can be used as a cutoff for what is to be considered as "flat" and what not.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-addangle-type-id1-id2-id3-"></a>addangle &lt;type&gt; &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;type&gt;</h4>
<p align="justify">Defines an angle of type <code>&lt;type&gt;</code> between the three specified atoms. All three atoms have to be contained in the specified atom selection ('all' if none is given) or else the command is ignored. No further checks are being performed on the input.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-delangle-id1-id2-id3-"></a>delangle &lt;id1&gt; &lt;id2&gt; &lt;id3&gt;</h4>
<p align="justify">Deletes an angle between the three specified atoms. Does nothing if not all three atom indices are contained within the given selection (default 'all').</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-getanglelist"></a>getanglelist</h4>
<p align="justify">Returns a list of defined angles with each entry in the format <code>{type &lt;index 1&gt; &lt;index 2&gt; &lt;index 3&gt;}</code>. The type name may be set to <code>{}</code>, if no angletype has been set. The list is printed unsorted as it is stored in VMD.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-setanglelist-list-"></a>setanglelist &lt;list&gt;</h4>
<p align="justify">Resets the angle definitions from a list in a format as returned by <code style="color:rgb(0, 96, 0)">topo getanglelist</code>. This is essentially a shortcut for calling <code style="color:rgb(0, 96, 0)">topo clearbonds</code> and a sequence of <code style="color:rgb(0, 96, 0)">topo addangle</code> commands with some optimization for the case of a selection encompassing all atoms.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-adddihedral-type-id1-id2-id3-id4-"></a>adddihedral &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;type&gt;</h4>
<p align="justify">Defines a dihedral of type <code style="color:rgb(0, 96, 0)">&lt;type&gt;</code> between the four specified atoms. All four atoms have to be contained in the specified atom selection ('all' if none is given) or else the command is ignored. No further checks are being performed on the input.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-deldihedral-idx1-id2-id3-id4-"></a>deldihedral &lt;idx1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</h4>
<p align="justify">Deletes the dihedral between the four specified atoms. Does nothing if not all four atom indices are contained within the given selection (default 'all').</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-addimproper-type-id1-id2-id3-id4-"></a>addimproper &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;type&gt;</h4>
<p align="justify">Defines an improper of type <code style="color:rgb(0, 96, 0)">&lt;type&gt;</code> between the four specified atoms. All four atoms have to be contained in the specified atom selection ('all' if none is given) or else the command is ignored. No further checks are being performed on the input.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-delimproper-id1-id2-id3-id4-"></a>delimproper &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt;</h4>
<p align="justify">Deletes the improper between the four specified atoms. Does nothing if not all four atom indices are contained within the given selection (default 'all').</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-get-dihedral-improper-list"></a>get(dihedral|improper)list</h4>
<p align="justify">Returns a list of defined dihedrals or impropers with each entry in the format <code style="color:rgb(0, 96, 0)">{type &lt;index 1&gt; &lt;index 2&gt; &lt;index 3&gt; &lt;index 4&gt;}</code>. The type name may be set to <code style="color:rgb(0, 96, 0)">{}</code>, if no type has been set. The list is printed unsorted as it is stored in VMD.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-set-dihedral-improper-list-list-"></a>set(dihedral|improper)list &lt;list&gt;</h4>
<p align="justify">Resets the dihedral or improper definitions from a list in a format as returned by <code style="color:rgb(0, 96, 0)">topo getdihedrallist </code>or <code style="color:rgb(0, 96, 0)">topo getimproperlist</code>. This is essentially a shortcut notation for clearing and then resetting them individually.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-addcrossterm"></a>addcrossterm &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;id5&gt; &lt;id6&gt; &lt;id7&gt; &lt;id8&gt;</h4>
<p align="justify">Defines a crossterm between the eight specified atoms. All eight atoms have to be contained in the specified atom selection ('all' if none is given) or else the command is ignored. No further checks are being performed on the input.</p>
<h4 style="color:rgb(51, 51, 51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-delcrossterm"></a>delcrossterm  &lt;id1&gt; &lt;id2&gt; &lt;id3&gt; &lt;id4&gt; &lt;id5&gt; &lt;id6&gt; &lt;id7&gt; &lt;id8&gt;</h4>
<p align="justify">Deletes the crossterm between the eight specified atoms. Does nothing if not all eight atom indices are contained within the given selection (default 'all').</p>
<h4 style="color:rgb(51,51,51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-getcrosstermlist"></a>getcrosstermlist</h4>
<p align="justify">Returns a list of defined crossterms with each entry in the format&nbsp;<code style="color:rgb(0,96,0)">{&lt;index 1&gt; &lt;index 2&gt; &lt;index 3&gt; &lt;index 4&gt;&nbsp;</code><span style="color:rgb(0,96,0);font-family:monospace;line-height:1.25;font-size:10pt">&lt;index 5&gt; &lt;index 6&gt; &lt;index 7&gt; &lt;index 8</span><code style="text-align:left;line-height:1.25;font-size:10pt">&gt;}</code><span style="text-align:left;line-height:1.25;font-size:10pt">. </span><span style="text-align:left;line-height:1.25;font-size:10pt">The list is printed unsorted as it is stored in VMD.</span></p>
<h4 style="color:rgb(51,51,51);margin-top:5px;margin-right:0px;margin-bottom:5px;margin-left:0px"><a name="TOC-setcrosstermlist"></s>setcrosstermlist &lt;list&gt;</h4>
<p align="justify">Resets the crossterm definitions from a list in a format as returned by&nbsp;<code style="color:rgb(0,96,0)">topo getcrosstermlist</code>.&nbsp;This is essentially a shortcut notations for clearing and then resetting them individually.</p>

<h3><a name="TOC-File-I-O-Commands"></a>File I/O Commands</h3>
<p align="justify">TopoTools provides a number of file I/O commands that contrast from the molfile plugins in such that they use Tcl scripting to read and write files. This provides additional flexibility and allows to easily pass flags to the reader or writer, that are not available in the molfile plugin API, however, it may also results in reduced reading performance. All of the file I/O commands also use the topo prefix and support the commonly supported optional flags for specifying molecule id and atom selection.</p>
<h4><a name="TOC-readlammpsdata-file-name-atom-style"></a>readlammpsdata &lt;file name&gt; [&lt;atom style&gt;]</h4>
<p align="justify">Read in atom coordinates, properties, bond, angle, dihedral and other related topology info from a <a href="http://lammps.sandia.gov" target="_blank" rel="nofollow">LAMMPS</a> data file, i.e. a file suitable for the <code>read_data</code> command. This can be used to check a data file for its validity (e.g. after using <code>restart2data</code>), for manipulations from within VMD, or to generate a .psf file to be used for visualization of <code>.dcd</code> or <code>.xtc</code> format trajectory files in VMD. The 'atom style' is the value given to the <code>atom_style</code> command in the LAMMPS input file (by default TopoTools will try to infer the atom style from information embedded in the data file as comments; if no such hints are present, it will use 'full'). This subcommand creates a new molecule in VMD and returns its molecule id or -1 in case of failure. The -sel parameter is currently ignored.</p>
<h4><a name="TOC-writelammpsdata-file-name-atom-styl"></a>writelammpsdata &lt;file name&gt; [&lt;atom style&gt;]</h4>
<p align="justify">Write out atom coordinates, properties, bond, angle, dihedral and other related topology info stored inside VMD to a <a href="http://lammps.sandia.gov/" target="_blank" rel="nofollow">LAMMPS</a> data file, i.e. a file suitable for the <code>read_data</code> command. This this way VMD can be used to build LAMMPS input with Tcl scripting and convert existing inputs from other MD codes to be used in LAMMPS. For some examples, please see the <a href="https://sites.google.com/site/akohlmey/software/topotools/topotools-tutorial---introduction">TopoTools tutorials</a>. The 'atom style' is the value you want to give to the <code>atom_style</code> command in the LAMMPS input file (default is 'full'). Only data that is present will be written.</p>
<h4><a name="TOC-readvarxyz-file-name-"></a>readvarxyz &lt;file name&gt;</h4>
<p align="justify">Read in an xyz-format trajectory file (in xmol style) with a varying number of atoms per frame. This format is normally not supported in VMD and the script circumvents the restriction by automatically adding a sufficient number of dummy particles. Whether an atom is actually present in a given frame or not is flagged by the value of the corresponding <code>user</code> field, which is set to either <code>1.0</code> or <code>-1.0</code>, respectively. For efficiency reasons the atoms are sorted by type, thus atom order and bonding is not preserved. This subcommand creates a new molecule and returns its molecule id or -1, in case of failure.</p>
<h4><a name="TOC-writevarxyz-file-name-selmod-sel-fi"></a>writevarxyz &lt;file name&gt; [selmod &lt;sel&gt;] [first|last|step &lt;frame]</h4>
<div>Write out an xyz-format trajectory file with a varying number of atoms per frame. This is the counterpart to the readvarxyz subcommand. The optional selection string defines how atoms for each frame have to be selected. If not given, as selection string of "user &gt; 0" is assumed.</div>
<h4><a name="TOC-writegmxtop-file-name-"></a>writegmxtop &lt;file name&gt; [&lt;list of CHARMM parameter files&gt;]</h4>
<p align="justify">Write a <a href="http://www.gromacs.org" target="_blank" rel="nofollow">gromacs</a>-style topology file that can be used in combination with a .gro or .pdb file to generate a .tpr file with the gromacs <b>grompp</b> tool. Such .tpr files are used to run simulations and for some of the more advanced gromacs analysis tools. If one or more parameter files (in CHARMM format) are provided, the resulting topology file is suitable for running MD simulations using the provided parameters. This allows the preparation of systems with CHARMM tools and to run the simulations with gromacs instead. A paper describing this <i>TopoGromacs</i> functionality is available at <a href="http://dx.doi.org/10.1021/acs.jcim.6b00103" target="_blank" rel="nofollow">doi:10.1021/acs.jcim.6b00103</a>. If the parameter files are omitted, dummy values are included instead so that the generated <b>incomplete</b> topology (and the from it generated .tpr file) are still sufficient to analyze trajectories, since analysis tools do not need force field parameters. This is useful for using gromacs tools to analyse trajectories that were not generated with gromacs and thus no .tpr file exists. Such a topology/.tpr file with <b>dummy</b> parameters is in <b><u>no way</u></b> suitable to start a correct MD simulation, though. Usage example:</p><div class="sites-codeblock sites-codesnippet-block"><code>package require topotools 1.6</code><br /><code># Load the structure into VMD.</code><br /><code>mol new structure.psf</code><br /><code>mol addfile structure.pdb</code><br /><code># Pass along a list of parameters to generate structure.top, suitable for preparing gromacs simulations.</code><br /><code>topo writegmxtop structure.top [list parameterfile1.prm parameterfile2.prm]</code><br /><code># This would be prepared for simulation using grompp to create a tpr file</code><br /><code># gmx grompp -f simulationsetup.mdp -c structure.pdb -p structure.top -o simulation.tpr</code></div><div><br />

<h3><a name="TOC-Utility-Functions"></a>Utility Functions</h3>
<p align="justify">These are useful and convenient tools written on top of the topotools API. You can access them directly with their <code>::TopoTools::</code> namespace prefix or use <code>namespace import ::TopoTools::&lt;pattern&gt;</code> to import some or all of them (with the pattern '*') into your current namespace.</p>
<h4><a name="TOC-mergemols-list-of-molecule-ids-"></a>mergemols &lt;list of molecule ids&gt;</h4>
<p align="justify">Combines multiple separate molecules into one file. This is non-destructive and will create a new molecule. The molecule id of the new molecule is returned, or -1 in case of a failure. Usage example:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>package require topotools 1.6</code>
  <div><code># load to be merged molecules into VMD</code></div>
  <div><code>set midlist {}</code></div>
  <div><code>set mol [mol new part1.psf waitfor all]</code></div>
  <div><code>mol addfile part1.pdb</code></div>
  <div><code>lappend midlist $mol</code></div>
  <div><code>set mol [mol new part2.psf waitfor all]</code></div>
  <div><code>mol addfile part2.pdb $mol</code></div>
  <div><code>lappend midlist $mol</code></div>
  <div><code># do the magic</code></div>
  <div><code>set mol [::TopoTools::mergemols $midlist]</code></div>
  <div><code>animate write psf merged.psf $mol</code></div>
  <div><code>animate write pdb merged.pdb $mol</code></div>
</div>

<h4><a name="TOC-selections2mol-list-of-atom-selecti"></a>selections2mol &lt;list of atom selections&gt;</h4><p align="justify">This is very similar to the previous <code>mergemols</code> command. It combines one or multiple atom selections, which can be taken from different molecules, into one new molecule. This is also non-destructive and will create a new molecule. The molecule id of the new molecule is returned, or -1 in case of a failure. Usage example:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>package require topotools 1.6</code>
  <div><code>set sellist {}</code></div>
  <div><code>set sel [atomselect 0 protein]</code></div>
  <div><code>lappend sellist $sel</code></div>
  <div><code>set sel [atomselect 0 protein]</code></div>
  <div><code>$sel frame 200 </code></div>
  <div><code>$sel moveby {50.0 50.0 0.0}</code></div>
  <div><code>lappend sellist $sel</code></div>
  <div><code>set sel [atomselect 1 "same residue as (within 3.0 of chain L)"]</code></div>
  <div><code>lappend sellist $sel</code></div>
  <div><code># do the magic</code></div>
  <div><code>set mol [::TopoTools::selections2mol $sellist]</code></div>
  <div><code>animate write psf combinedsel.psf $mol</code></div>
  <div><code>animate write pdb combinedsel.pdb $mol</code></div>
</div>

<h4><a name="TOC-replicatemol-mol-nx-ny-nz-"></a>replicatemol &lt;mol&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt;</h4>
<p>Replicate the current unitcell according to integer replicate counts. Usage example:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>package require topotools 1.5 </code><div><code># load a molecule</code></div><div><code>set mol [mol new pegc12e8-small.xml type hoomd waitfor all]</code></div><div><code># do the magic</code></div><div><code>set newmol [::TopoTools::replicatemol $mol 2 2 1 ]</code></div><div><code>animate write hoomd replicated.xml $newmol</code></div></div>
<div><br />
</div></div></td></tr></tbody></table>
</div> 
</div> 

<h3 ><a name="TOC-Author"></a>Author</h3>
<p><a href="http://sites.google.com/site/akohlmey/">Axel Kohlmeyer</a> with contributions from Josh Vermaas (TopoGromacs, i.e. fully working gromacs topology files for CHARMM style parameter files) and  Konstantin W (replicatemols for non-orthogonal cells) </p>


<!--#include virtual="/include/footer-over.shtml"-->
