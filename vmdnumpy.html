

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VMD Numpy &mdash; vmd-python 3.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="vmd-python 3.0.1 documentation" href="index.html"/>
        <link rel="next" title="vmd.vmdnumpy.atomselect" href="api/generated/vmd.vmdnumpy.atomselect.html"/>
        <link rel="prev" title="vmd.vmdmenu.show" href="api/generated/vmd.vmdmenu.show.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> vmd-python
          

          
          </a>

          
            
            
              <div class="version">
                3.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="animate.html">Animate</a></li>
<li class="toctree-l1"><a class="reference internal" href="atomsel.html">Atomsel</a></li>
<li class="toctree-l1"><a class="reference internal" href="axes.html">Axes</a></li>
<li class="toctree-l1"><a class="reference internal" href="color.html">Color</a></li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaltcl.html">Evaltcl</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphics.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="imd.html">IMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">Label</a></li>
<li class="toctree-l1"><a class="reference internal" href="material.html">Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="measure.html">Measure</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecule.html">Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="molrep.html">Molrep</a></li>
<li class="toctree-l1"><a class="reference internal" href="mouse.html">Mouse</a></li>
<li class="toctree-l1"><a class="reference internal" href="render.html">Render</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection.html">Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="trans.html">Trans</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmdcallbacks.html">VMD Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmdcallbacks.html#vmd-menu">VMD Menu</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VMD Numpy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/generated/vmd.vmdnumpy.atomselect.html">vmd.vmdnumpy.atomselect</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/generated/vmd.vmdnumpy.positions.html">vmd.vmdnumpy.positions</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/generated/vmd.vmdnumpy.timestep.html">vmd.vmdnumpy.timestep</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/generated/vmd.vmdnumpy.velocities.html">vmd.vmdnumpy.velocities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">vmd-python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>VMD Numpy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/vmdnumpy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vmd-numpy">
<h1>VMD Numpy<a class="headerlink" href="#vmd-numpy" title="Permalink to this headline">¶</a></h1>
<p>The <cite>vmdnumpy</cite> module exposes molecular coordinates in-memory as a numpy array.
This allows extremely efficient analyses to be conducted.</p>
<p>Take care– the coordinates given are the same as those in memory. Any
inadveretent modification will require you to reload your trajectory to restore
the original values! However, this can be very useful in implementing trajectory
smoothing functions, etc.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="api/generated/vmd.vmdnumpy.atomselect.html#vmd.vmdnumpy.atomselect" title="vmd.vmdnumpy.atomselect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atomselect</span></code></a></td>
<td>Return an array of ints representing flags for on/off atoms in an atom selection</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/generated/vmd.vmdnumpy.positions.html#vmd.vmdnumpy.positions" title="vmd.vmdnumpy.positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></a></td>
<td>Return a zero-copy reference to atomic coordinates</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/generated/vmd.vmdnumpy.timestep.html#vmd.vmdnumpy.timestep" title="vmd.vmdnumpy.timestep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">timestep</span></code></a></td>
<td>Return a zero-copy reference to atomic coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/generated/vmd.vmdnumpy.velocities.html#vmd.vmdnumpy.velocities" title="vmd.vmdnumpy.velocities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocities</span></code></a></td>
<td>Return a zero-copy reference to atomic velocites, or None if no velocity information is present</td>
</tr>
</tbody>
</table>
<p>For example, the following code will apply a Savitsky-Golay smoothing function
to the entire trajectory:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">savgol_filter</span>
<span class="kn">from</span> <span class="nn">vmd</span> <span class="kn">import</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">vmdnumpy</span>

<span class="k">def</span> <span class="nf">smooth_trajectory</span><span class="p">(</span><span class="n">molid</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">smoother</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">molecule</span><span class="o">.</span><span class="n">numframes</span><span class="p">(</span><span class="n">molid</span><span class="p">),</span> <span class="n">molecule</span><span class="o">.</span><span class="n">numatoms</span><span class="p">(</span><span class="n">molid</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>

    <span class="c1"># Copy timestep data to a 1D array to run filter on</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">numframes</span><span class="p">(</span><span class="n">molid</span><span class="p">)):</span>
        <span class="n">smoother</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmdnumpy</span><span class="o">.</span><span class="n">timestep</span><span class="p">(</span><span class="n">molid</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">smoothed</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">smoother</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">polyorder</span><span class="p">,</span>
                             <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>

    <span class="c1"># Copy filtered data back into coordinates</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">numframes</span><span class="p">(</span><span class="n">molid</span><span class="p">)):</span>
        <span class="n">conv</span> <span class="o">=</span> <span class="n">smoothed</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">molecule</span><span class="o">.</span><span class="n">numatoms</span><span class="p">(</span><span class="n">molid</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">vmdnumpy</span><span class="o">.</span><span class="n">timestep</span><span class="p">(</span><span class="n">molid</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">conv</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/generated/vmd.vmdnumpy.atomselect.html" class="btn btn-neutral float-right" title="vmd.vmdnumpy.atomselect" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api/generated/vmd.vmdmenu.show.html" class="btn btn-neutral" title="vmd.vmdmenu.show" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Robin Betz.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>